<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="bootstrap-template/layout/basic">
<th:block layout:fragment="title">
    <title>게시글 목록</title>
</th:block>

<th:block layout:fragment="main-content">
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center" id="post-container">
        </div>
</th:block>



<th:block layout:fragment="script">
    <script th:inline="javascript">
        /*<![CDATA[*/

        /* 게시글 리스트 조회 S */
        window.onload = () => {
            console.log("게시글 리스트 조회====================");
            findAllPost();
        }

        function findAllPost() {
            var list = [[${response.list}]];
            if (!list.length) {
                document.getElementById('post-container').innerHTML = '<div>검색 결과가 없습니다.</div>';
                return false;
            }
            var params = [[${params}]];

            drawList(list);
        }

        // 조회 목록
        function drawList(list) {
            var posting = '';
            list.forEach(obj => {
                console.log('오브젝트============');
                console.log(obj);

                var tag = obj.bbscttHashtag.split(',');
                console.log('해시태그');
                console.log(tag);

                posting += '<div class="col mb-5">' +
                    '<div class="card h-100">' +
                    '<img class="card-img-top" src="'+
                    obj.bbscttImage +
                    '" alt="..." />' +
                    '<div class="card-body">' +
                    '<div class="text-center">' +
                    '<h6 class="fw-bolder">' +
                    obj.bbscttSj +
                    '</h6>';

                // 별점
                posting += '<div class="d-flex justify-content-center small text-warning mb-2">';
                for (var i = 0; i < obj.bbscttGrade; i++) {
                    posting += '<div class="bi-star-fill"></div>';
                }

                for (var j = 0; j < 5 - obj.bbscttGrade; j++) {
                    posting += '<div class="bi-star"></div>';
                }
                posting += '</div>';


                // 해시태그(3개까지만 보이게 처리)
                posting += '<div class="text-xs">';
                var showSize = tag.length > 3? 3 : tag.length;
                for (var k = 0; k < showSize; k++) {
                    posting += '<span class="text-primary">#' + tag[k] +' </span>';
                }
                posting += '</div>';


                posting +=
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</div>';

            });
            document.getElementById('post-container').innerHTML = posting;
        }

        /* 게시글 리스트 조회 E */

    </script>

</th:block>
</html>